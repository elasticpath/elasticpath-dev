---
id: ms-graph-api
title: Microsoft Graph API Component
sidebar_label: Microsoft Graph API
description: Interact with the Microsoft Graph API. Learn more about using Composer's Microsoft Graph API component.
---

[//]: # "DO NOT EDIT THIS FILE MANUALLY."
[//]: # "This file was auto generated using scripts in docusaurus/scripts/components/"

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";
import ComponentInputsTable from "@site/src/components/component-inputs-table";
import ExampleIntegrationLink from "@site/src/components/example-integration-link";
import OAuthCallbackURL from "@site/src/components/oauth-callback-url";
import Screenshot from "@site/src/components/screenshot";
import Vimeo from "@site/src/components/vimeo";

<div className="avatar">
  <div className="avatar__photo-link avatar__photo avatar__photo--lg">
    <img
      src="data:image/png;base64,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"
      alt="Microsoft Graph API"
    />
  </div>
  <div className="avatar__intro">
    <h4 className="avatar__name">Interact with the Microsoft Graph API</h4>
    <small className="avatar__subtitle">
      Component key: <b>ms-graph-api</b>
    </small>
  </div>
</div>

## Description

[Microsft's Graph API](https://learn.microsoft.com/en-us/graph/use-the-api) allows you to interact with many Microsoft products from one API endpoint.
You can explore the Graph API using their [Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer) tool.

## Connections

### OAuth 2.0 Authorization Code

To use the Microsoft Graph API component, configure an OAuth 2.0 application through Active Directory in the [Microsoft Azure Portal](https://portal.azure.com/#home).

When creating the application you will be prompted to select the **Supported account types**.
Under this section, be sure to select **Accounts in any organizational directory (Any Azure AD directory - Multitenant)** so that users outside of your organization (i.e. your customers) can authenticate.
You will need to go to **Platforms** and add the **Web** platform.
In that section you should add Composer's OAuth 2.0 callback URL - https<!---->://oauth2.prismatic.io/callback - as a **Redirect URI**.

Next, go to **Certificates & Secrets** for the app and add a new **Client Secret**.
Copy the **value** (not ID) of the secret for future use.

You will also need the **Application (client) ID** from the "Overview" page.

Next, supply the following values to the **OAuth 2.0** connection in your integration within Composer:

- For **Client ID** and **Client Secret** enter the values that you got from the Microsoft Azure Portal.
- The **Scopes** your integration requries.
  You can find scopes on [Microsoft Graph permissions reference](https://learn.microsoft.com/en-us/graph/permissions-reference), or by making test calls in the [Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer).
- If you didn't select Multitenant when creating the Azure application, you will need to replace the **Authorize URL** and **Token URL** with ones specific to your tenant.

For more information regarding authenticating against the Microsoft Graph API refer to the [Microsoft documentation](https://docs.microsoft.com/en-us/graph/auth-v2-user).

<ComponentInputsTable
  inputs={[
    {
      placeholder: "Authorize URL",
      required: true,
      shown: true,
      comments:
        "The OAuth 2.0 Authorization URL for Microsoft's Graph API. If you have a multi-tenant application, you can use /common/ endpoints. If you have a single-tenant app, change these URLs to your tenant-specific ones.",
      key: "authorizeUrl",
      type: "string",
      default: "https://login.microsoftonline.com/common/oauth2/v2.0/authorize",
      label: "Authorize URL",
    },
    {
      placeholder: "Client ID",
      required: true,
      shown: true,
      key: "clientId",
      type: "string",
      default: "",
      label: "Client ID",
    },
    {
      placeholder: "Client secret value",
      required: true,
      shown: true,
      comments:
        "This is the 'value' (not ID) of the client secret you generated in Azure Portal.",
      key: "clientSecret",
      type: "password",
      default: "",
      label: "Client secret value",
    },
    {
      placeholder: "Scopes",
      required: false,
      shown: true,
      comments:
        "Add additional required scopes you identify on https://developer.microsoft.com/en-us/graph/graph-explorer to this list",
      key: "scopes",
      type: "string",
      default: "https://graph.microsoft.com/User.Read.All offline_access",
      label: "Scopes",
    },
    {
      placeholder: "Token URL",
      required: true,
      shown: true,
      comments:
        "The OAuth 2.0 Token URL for Microsoft's Graph API. If you have a multi-tenant application, you can use /common/ endpoints. If you have a single-tenant app, change these URLs to your tenant-specific ones.",
      key: "tokenUrl",
      type: "string",
      default: "https://login.microsoftonline.com/common/oauth2/v2.0/token",
      label: "Token URL",
    },
  ]}
/>

## Actions

<div id="rawrequest" />

### Raw Request

Send raw HTTP request to Microsoft Graph API | <small><b>key: rawRequest</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      placeholder: "Data to send",
      required: false,
      comments: "The HTTP body payload to send to the URL.",
      example: '{"exampleKey": "Example Data"}',
      key: "data",
      type: "string",
      default: "",
      label: "Data",
    },
    {
      required: false,
      comments: "Enabling this flag will log out the current request.",
      key: "debugRequest",
      type: "boolean",
      default: "false",
      label: "Debug Request",
    },
    {
      placeholder: "Data to send",
      required: false,
      comments: "File Data to be sent as a multipart form upload.",
      example: '[{key: "example.txt", value: "My File Contents"}]',
      key: "fileData",
      type: "string",
      default: "",
      collection: "keyvaluelist",
      label: "File Data",
    },
    {
      placeholder: "Data to send",
      required: false,
      comments: "The Form Data to be sent as a multipart form upload.",
      example: '[{"key": "Example Key", "value": new Buffer("Hello World")}]',
      key: "formData",
      type: "string",
      default: "",
      collection: "keyvaluelist",
      label: "Form Data",
    },
    {
      placeholder: "Header",
      required: false,
      comments: "A list of headers to send with the request.",
      example: "User-Agent: curl/7.64.1",
      key: "headers",
      type: "string",
      default: "",
      collection: "keyvaluelist",
      label: "Header",
    },
    {
      placeholder: "Max Retries",
      required: false,
      comments: "The maximum number of retries to attempt.",
      key: "maxRetries",
      type: "string",
      default: "0",
      label: "Max Retry Count",
    },
    {
      required: true,
      model: [
        {
          label: "DELETE",
          value: "DELETE",
        },
        {
          label: "GET",
          value: "GET",
        },
        {
          label: "HEAD",
          value: "HEAD",
        },
        {
          label: "LINK",
          value: "LINK",
        },
        {
          label: "OPTIONS",
          value: "OPTIONS",
        },
        {
          label: "PATCH",
          value: "PATCH",
        },
        {
          label: "POST",
          value: "POST",
        },
        {
          label: "PURGE",
          value: "PURGE",
        },
        {
          label: "PUT",
          value: "PUT",
        },
        {
          label: "UNLINK",
          value: "UNLINK",
        },
      ],
      comments: "The HTTP method to use.",
      key: "method",
      type: "string",
      default: "",
      label: "Method",
    },
    {
      placeholder: "Query Parameter",
      required: false,
      comments:
        "A list of query parameters to send with the request. This is the portion at the end of the URL similar to ?key1=value1&key2=value2.",
      key: "queryParams",
      type: "string",
      default: "",
      collection: "keyvaluelist",
      label: "Query Parameter",
    },
    {
      placeholder: "Response Type",
      required: true,
      comments:
        "The type of data you expect in the response. You can request json, text, or binary data.",
      model: [
        {
          label: "arraybuffer",
          value: "arraybuffer",
        },
        {
          label: "document",
          value: "document",
        },
        {
          label: "json",
          value: "json",
        },
        {
          label: "text",
          value: "text",
        },
      ],
      key: "responseType",
      type: "string",
      default: "json",
      label: "Response Type",
    },
    {
      required: false,
      comments:
        "If true, retries on all erroneous responses regardless of type.",
      key: "retryAllErrors",
      type: "boolean",
      default: "false",
      label: "Retry On All Errors",
    },
    {
      placeholder: "Retry Delay",
      required: false,
      comments: "The delay in milliseconds between retries.",
      key: "retryDelayMS",
      type: "string",
      default: "0",
      label: "Retry Delay (ms)",
    },
    {
      required: false,
      comments:
        "The maximum time that a client will await a response to its request",
      example: "2000",
      key: "timeout",
      type: "string",
      default: "",
      label: "Timeout",
    },
    {
      placeholder: "URL to call",
      required: true,
      comments:
        "Input the path only (/me/joinedTeams), The base URL is already included (https://graph.microsoft.com/v1.0). For example, to connect to https://graph.microsoft.com/v1.0/me/joinedTeams, only /me/joinedTeams is entered in this field.",
      example: "/me/joinedTeams",
      key: "url",
      type: "string",
      default: "",
      label: "URL",
    },
    {
      required: false,
      comments:
        "Specifies whether to use a pre-defined exponential backoff strategy for retries.",
      key: "useExponentialBackoff",
      type: "boolean",
      default: "false",
      label: "Use Exponential Backoff",
    },
  ]}
/>

<hr className="componentActionSeparator" />
